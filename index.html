// Delta Chart
deltaChart = new Chart(deltaCtx, {
    type: "line",
    data: {
        labels: [],
        datasets: [
            {
                label: "Delta (Bids - Asks)",
                data: [],
                borderColor: "#ffffff",
                borderWidth: 2,
                fill: true,
                backgroundColor: function(context) {
                    const value = context.dataset.data[context.dataIndex];
                    return value >= 0 ? "rgba(76, 175, 80, 0.3)" : "rgba(244, 67, 54, 0.3)"; // Green for positive, red for negative
                },
            }
        ]
    },
    options: {
        responsive: true,
        scales: {
            x: { title: { display: true, text: "Time" } },
            y: { title: { display: true, text: "Delta (USDT)" } }
        },
        plugins: {
            legend: { display: true }
        }
    }
});

// Update Delta Chart
deltaChart.data.labels.push(currentTime);
deltaChart.data.datasets[0].data.push(delta);

if (deltaChart.data.labels.length > limit) {
    deltaChart.data.labels.shift();
    deltaChart.data.datasets[0].data.shift();
}

// Update Fill Color Dynamically
deltaChart.data.datasets[0].backgroundColor = deltaChart.data.datasets[0].data.map(value =>
    value >= 0 ? "rgba(76, 175, 80, 0.3)" : "rgba(244, 67, 54, 0.3)"
);

deltaChart.update();