<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OI/Volume and BTC Price Comparison</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #121212;
            color: white;
            overflow: hidden;
        }

        #chartContainer {
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        canvas {
            width: 100%;
            height: 50%;
        }

        #oiVolumeChart {
            height: 50%;
        }

        #btcPriceChart {
            height: 50%;
        }
    </style>
</head>
<body>

<div id="chartContainer">
    <!-- OI/Volume Ratio Chart -->
    <canvas id="oiVolumeChart"></canvas>

    <!-- BTC Price Chart -->
    <canvas id="btcPriceChart"></canvas>
</div>

<script>
    const symbol = 'BTCUSDT';
    const interval = '5m';
    const chartData = {
        labels: [],
        datasets: [{
            label: 'OI/Volume Ratio',
            data: [],
            borderColor: 'rgba(75, 192, 192, 1)',
            backgroundColor: 'rgba(75, 192, 192, 0.2)',
            fill: true,
            tension: 0.1
        }]
    };

    const chartOptions = {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
            x: {
                type: 'linear',
                position: 'bottom',
                title: {
                    display: true,
                    text: 'Time (Unix Timestamp)'
                }
            },
            y: {
                title: {
                    display: true,
                    text: 'OI/Volume Ratio'
                },
                beginAtZero: true
            }
        },
        plugins: {
            legend: {
                display: true
            }
        }
    };

    const btcPriceData = {
        labels: [],
        datasets: [{
            label: 'BTC/USDT Price',
            data: [],
            borderColor: 'rgba(255, 99, 132, 1)',
            backgroundColor: 'rgba(255, 99, 132, 0.2)',
            fill: true,
            tension: 0.1
        }]
    };

    const btcPriceOptions = {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
            x: {
                type: 'linear',
                position: 'bottom',
                title: {
                    display: true,
                    text: 'Time (Unix Timestamp)'
                }
            },
            y: {
                title: {
                    display: true,
                    text: 'BTC Price (USDT)'
                },
                beginAtZero: false
            }
        },
        plugins: {
            legend: {
                display: true
            }
        }
    };

    const oiVolumeCtx = document.getElementById('oiVolumeChart').getContext('2d');
    const btcPriceCtx = document.getElementById('btcPriceChart').getContext('2d');

    const oiVolumeChart = new Chart(oiVolumeCtx, {
        type: 'line',
        data: chartData,
        options: chartOptions
    });

    const btcPriceChart = new Chart(btcPriceCtx, {
        type: 'line',
        data: btcPriceData,
        options: btcPriceOptions
    });

    async function fetchBinanceData() {
        const url = `https://api.binance.com/api/v3/klines?symbol=${symbol}&interval=${interval}&limit=288`;
        const response = await fetch(url);
        const data = await response.json();

        const newLabels = [];
        const newOIData = [];
        const newBTCData = [];

        data.forEach(candle => {
            const timestamp = candle[0];
            const volume = parseFloat(candle[5]);
            const oi = parseFloat(candle[7]); // Assuming this is the open interest, which may not always be available directly
            const ratio = oi / volume;
            const btcPrice = parseFloat(candle[4]);

            newLabels.push(timestamp);
            newOIData.push(ratio);
            newBTCData.push(btcPrice);
        });

        chartData.labels = newLabels;
        chartData.datasets[0].data = newOIData;
        btcPriceData.labels = newLabels;
        btcPriceData.datasets[0].data = newBTCData;

        oiVolumeChart.update();
        btcPriceChart.update();
    }

    fetchBinanceData();
    setInterval(fetchBinanceData, 5000); // Refresh every 5 seconds for live updates
</script>

</body>
</html>