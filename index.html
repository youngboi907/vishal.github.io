<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OI/Volume Ratio Chart</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #121212;
            color: white;
        }

        .container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
        }

        .date-selector {
            margin: 20px;
        }

        canvas {
            width: 80%;
            height: 50vh;
        }
    </style>
</head>
<body>

<div class="container">
    <!-- Date Selector for Historical Data -->
    <div class="date-selector">
        <label for="datePicker">Select Date:</label>
        <input type="date" id="datePicker" value="2024-12-29">
    </div>
    
    <!-- OI/Volume Ratio Chart -->
    <canvas id="oiVolumeChart"></canvas>
</div>

<script>
    // Function to fetch historical data for a selected day
    function fetchDataForDate(date) {
        const sampleData = {
            "2024-12-29": [
                { timestamp: "2024-12-29T00:00", oi: 1000, volume: 500 },
                { timestamp: "2024-12-29T01:00", oi: 1500, volume: 600 },
                { timestamp: "2024-12-29T02:00", oi: 1300, volume: 550 },
                // Continue this pattern for every hour (or minute) of the day
                { timestamp: "2024-12-29T23:00", oi: 1800, volume: 700 }
            ],
            "2024-12-30": [
                { timestamp: "2024-12-30T00:00", oi: 1200, volume: 700 },
                { timestamp: "2024-12-30T01:00", oi: 1600, volume: 800 },
                { timestamp: "2024-12-30T02:00", oi: 1650, volume: 750 },
                { timestamp: "2024-12-30T23:00", oi: 1400, volume: 600 }
            ]
        };
        return sampleData[date] || [];
    }

    // Initialize chart
    const ctx = document.getElementById("oiVolumeChart").getContext("2d");
    const oiVolumeChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: [],
            datasets: [{
                label: 'OI/Volume Ratio',
                data: [],
                borderColor: 'rgba(75, 192, 192, 1)',
                fill: false,
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: {
                    title: { display: true, text: "Time" }
                },
                y: {
                    title: { display: true, text: "OI/Volume Ratio" }
                }
            }
        }
    });

    // Update chart with data for the selected day
    function updateChart(date) {
        const data = fetchDataForDate(date);

        const timestamps = data.map(item => item.timestamp);
        const oiVolumeRatios = data.map(item => item.oi / item.volume);

        oiVolumeChart.data.labels = timestamps;
        oiVolumeChart.data.datasets[0].data = oiVolumeRatios;
        oiVolumeChart.update();
    }

    // Event listener for date change
    document.getElementById("datePicker").addEventListener("input", (event) => {
        const selectedDate = event.target.value;
        updateChart(selectedDate);
    });

    // Initially load data for the default date (e.g., 2024-12-29)
    updateChart("2024-12-29");
</script>

</body>
</html>