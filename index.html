// Delta Chart
deltaChart = new Chart(deltaCtx, {
    type: "line",
    data: {
        labels: [],
        datasets: [
            {
                label: "Delta (Bids - Asks)",
                data: [],
                borderColor: function(context) {
                    const value = context.dataset.data[context.dataIndex];
                    return value >= 0 ? "#4caf50" : "#f44336"; // Green for positive, red for negative
                },
                borderWidth: 2,
                pointBackgroundColor: function(context) {
                    const value = context.dataset.data[context.dataIndex];
                    return value >= 0 ? "#4caf50" : "#f44336";
                },
                pointRadius: 5,
                fill: false,
            }
        ]
    },
    options: {
        responsive: true,
        scales: {
            x: { title: { display: true, text: "Time" } },
            y: { title: { display: true, text: "Delta (USDT)" } }
        }
    }
});

// Update Delta Chart
deltaChart.data.labels.push(currentTime);
deltaChart.data.datasets[0].data.push(delta);

if (deltaChart.data.labels.length > limit) {
    deltaChart.data.labels.shift();
    deltaChart.data.datasets[0].data.shift();
}

// Apply color dynamically
deltaChart.data.datasets[0].borderColor = deltaChart.data.datasets[0].data.map(value =>
    value >= 0 ? "#4caf50" : "#f44336"
);
deltaChart.data.datasets[0].pointBackgroundColor = deltaChart.data.datasets[0].data.map(value =>
    value >= 0 ? "#4caf50" : "#f44336"
);

deltaChart.update();