<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OI/Volume Ratio - BTC/USDT Futures</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* General Styles */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #121212;
            color: white;
            overflow: hidden;
        }

        /* Chart Container */
        #chart-container {
            width: 100%;
            height: 100vh;
        }

        canvas {
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>

<div id="chart-container">
    <canvas id="oiVolumeChart"></canvas>
</div>

<script>
// Initialize the chart
const ctx = document.getElementById('oiVolumeChart').getContext('2d');

let oiVolumeChart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: [], // Time labels (timestamps)
        datasets: [{
            label: 'OI/Volume Ratio',
            borderColor: 'rgba(75, 192, 192, 1)',
            backgroundColor: 'rgba(75, 192, 192, 0.2)',
            data: [],
            fill: false,
            borderWidth: 2
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
            x: {
                type: 'linear',
                position: 'bottom',
                title: {
                    display: true,
                    text: 'Time (Unix Timestamp)'
                },
                ticks: {
                    autoSkip: true,
                    maxTicksLimit: 20
                }
            },
            y: {
                title: {
                    display: true,
                    text: 'OI/Volume Ratio'
                }
            }
        }
    }
});

// Function to fetch live data from Binance API
async function fetchBinanceData() {
    const url = 'https://fapi.binance.com/fapi/v1/ticker/24hr?symbol=BTCUSDT';
    try {
        const response = await fetch(url);
        const data = await response.json();
        
        // Extract Open Interest and Volume from the data
        const openInterest = parseFloat(data.openInterest);  // Open Interest in BTC
        const volume = parseFloat(data.volume);  // 24h volume in BTC
        
        // Calculate OI/Volume Ratio
        const oiVolumeRatio = openInterest / volume;
        const timestamp = Date.now();
        
        // Update the chart with new data
        updateChart(timestamp, oiVolumeRatio);
    } catch (error) {
        console.error('Error fetching Binance data:', error);
    }
}

// Function to update the chart with new data
function updateChart(timestamp, oiVolumeRatio) {
    // Add new data to the chart
    oiVolumeChart.data.labels.push(timestamp);
    oiVolumeChart.data.datasets[0].data.push(oiVolumeRatio);
    
    // Limit the chart data to the last 24 hours (or so many points for the day)
    const maxDataPoints = 288; // 24 hours * 60 minutes / 5 minute candles
    if (oiVolumeChart.data.labels.length > maxDataPoints) {
        oiVolumeChart.data.labels.shift();
        oiVolumeChart.data.datasets[0].data.shift();
    }

    // Refresh the chart
    oiVolumeChart.update();
}

// Fetch data every minute (or adjust the frequency)
setInterval(fetchBinanceData, 60000); // 60,000 ms = 1 minute

// Initial data fetch when the page loads
fetchBinanceData();
</script>

</body>
</html>